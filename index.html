<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ë§ˆìŒ ë„ì›€ê¸°ê´€ ê¸°ì–µí•˜ê¸° (ì‹œì‘ ì „ ê³µê°œ)</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 10px;
    background-color: #fafafa;
  }

  #info {
    margin: 15px auto;
    font-size: 18px;
  }

  .board {
    display: flex;
    flex-wrap: wrap;
    max-width: 1000px;
    width: 90%;
    margin: 20px auto;
    justify-content: center;
  }

  .card {
    width: 200px;
    height: 290px;
    margin: 10px;
    border: 2px solid #333;
    cursor: pointer;
    position: relative;
    box-sizing: border-box;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    user-select: none;
  }

  .card img {
    width: 100%;
    height: 100%;
    display: none;
  }

  .card.flipped img {
    display: block;
  }

  .card.back {
    background: url('back.png') no-repeat center/cover;
  }

  #message {
    font-size: 20px;
    margin-top: 10px;
    min-height: 1.5em;
  }

  /* ë°˜ì‘í˜• ì¹´ë“œ í¬ê¸° ì¡°ì ˆ */
  @media (max-width: 480px) {
    .card {
      width: 70px;
      height: 105px;
      margin: 6px;
    }
    #info {
      font-size: 16px;
    }
    #message {
      font-size: 18px;
    }
  }

  @media (min-width: 481px) and (max-width: 768px) {
    .card {
      width: 85px;
      height: 130px;
      margin: 8px;
    }
    #info {
      font-size: 17px;
    }
    #message {
      font-size: 19px;
    }
  }
</style>
</head>
<body>

<h1>ë§ˆìŒ ë„ì›€ê¸°ê´€ ê¸°ì–µí•˜ê¸°</h1>

<div id="info">
  ë‚¨ì€ ì‹œê°„: <span id="timer">60</span>ì´ˆ |
  <button id="hintBtn">íŒíŠ¸ ë³´ê¸°</button>
  íŒíŠ¸ ë‚¨ì€ íšŸìˆ˜: <span id="hintCount">2</span>
</div>

<div class="board" id="board"></div>

<p id="message">ì¹´ë“œë¥¼ ì ì‹œ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤...</p>

<script>
const cardImages = [
  'img1.png', 'img2.png',
  'img3.png', 'img4.png'
];

const cards = cardImages.concat(cardImages);
cards.sort(() => Math.random() - 0.5);

const board = document.getElementById('board');
const message = document.getElementById('message');
const timerSpan = document.getElementById('timer');
const hintBtn = document.getElementById('hintBtn');
const hintCountSpan = document.getElementById('hintCount');

let firstCard = null;
let secondCard = null;
let lockBoard = true; // ì‹œì‘ ì „ ì ê¸ˆ
let matches = 0;

let timeLeft = 60; // ì œí•œì‹œê°„ 60ì´ˆ
let timerInterval = null;

let hintCount = 2;

function createCard(src, index) {
  const card = document.createElement('div');
  card.classList.add('card');
  card.classList.add('flipped'); // ì‹œì‘ ì‹œ ëª¨ë‘ ì•ë©´ ë³´ì—¬ì£¼ê¸°
  card.dataset.image = src;
  card.dataset.index = index;

  const img = document.createElement('img');
  img.src = src;
  card.appendChild(img);

  card.addEventListener('click', clickHandler);

  return card;
}

function clickHandler(e) {
  if(lockBoard) return;
  const card = e.currentTarget;
  if(card === firstCard) return;

  card.classList.remove('back');
  card.classList.add('flipped');

  if(!firstCard) {
    firstCard = card;
    return;
  }

  secondCard = card;
  lockBoard = true;

  if(firstCard.dataset.image === secondCard.dataset.image) {
    matches++;
    firstCard.classList.add('matched');
    secondCard.classList.add('matched');
    firstCard.removeEventListener('click', clickHandler);
    secondCard.removeEventListener('click', clickHandler);
    resetTurn();

    if(matches === cardImages.length) {
      clearInterval(timerInterval);
      message.textContent = 'ğŸ‰ ëª¨ë“  ì¹´ë“œë¥¼ ë§ì·„ìŠµë‹ˆë‹¤! ğŸ‰';
      lockBoard = true;
    }
  } else {
    setTimeout(() => {
      firstCard.classList.add('back');
      firstCard.classList.remove('flipped');
      secondCard.classList.add('back');
      secondCard.classList.remove('flipped');
      resetTurn();
    }, 1000);
  }
}

function resetTurn() {
  firstCard = null;
  secondCard = null;
  lockBoard = false;
}

function startGame() {
  cards.forEach((src, i) => {
    board.appendChild(createCard(src, i));
  });

  setTimeout(() => {
    const allCards = document.querySelectorAll('.card');
    allCards.forEach(card => {
      card.classList.add('back');
      card.classList.remove('flipped');
    });
    lockBoard = false;
    message.textContent = 'ì¹´ë“œë¥¼ ë§ì¶°ë³´ì„¸ìš”!';

    timerInterval = setInterval(() => {
      timeLeft--;
      timerSpan.textContent = timeLeft;
      if(timeLeft <= 0) {
        clearInterval(timerInterval);
        message.textContent = 'â° ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!';
        lockBoard = true;
        // ë‚¨ì€ ì¹´ë“œ ëª¨ë‘ ì•ë©´ìœ¼ë¡œ ë’¤ì§‘ê¸° ë° í´ë¦­ ë§‰ê¸°
        const allCards = document.querySelectorAll('.card');
        allCards.forEach(card => {
          card.classList.remove('back');
          card.classList.add('flipped');
          card.removeEventListener('click', clickHandler);
        });
      }
    }, 1000);
  }, 3000);
}

// íŒíŠ¸ ë²„íŠ¼ ê¸°ëŠ¥
hintBtn.addEventListener('click', () => {
  if(lockBoard) return; // íŒíŠ¸ ì¤‘ì´ê±°ë‚˜ ê²Œì„ ì ê¸ˆ ìƒíƒœë©´ ë¬´ì‹œ
  if(hintCount <= 0) {
    alert('íŒíŠ¸ íšŸìˆ˜ë¥¼ ëª¨ë‘ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.');
    return;
  }

  hintCount--;
  hintCountSpan.textContent = hintCount;

  lockBoard = true; // íŒíŠ¸ ë³´ì—¬ì£¼ëŠ” ë™ì•ˆ í´ë¦­ ì ê¸ˆ

  const allCards = document.querySelectorAll('.card');
  // ëª¨ë“  ì¹´ë“œ ì•ë©´ ë³´ì—¬ì£¼ê¸°
  allCards.forEach(card => {
    card.classList.remove('back');
    card.classList.add('flipped');
  });

  // 2ì´ˆ í›„ ë‹¤ì‹œ ë’¤ì§‘ê¸° (ë§ì¶˜ ì¹´ë“œ ì œì™¸)
  setTimeout(() => {
    allCards.forEach(card => {
      if(!card.classList.contains('matched')) {
        card.classList.add('back');
        card.classList.remove('flipped');
      }
    });
    lockBoard = false;
  }, 2000);
});

startGame();
</script>

</body>
</html>
